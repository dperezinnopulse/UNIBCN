<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test API - UB Actividad 1</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h1 class="mb-4">🧪 Test API - UB Actividad 1</h1>
        
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Estado del Backend</h5>
                    </div>
                    <div class="card-body">
                        <div id="backend-status" class="alert alert-info">
                            <i class="bi bi-hourglass-split"></i> Verificando conexión...
                        </div>
                        <button class="btn btn-primary" onclick="testBackend()">
                            <i class="bi bi-arrow-clockwise"></i> Probar Conexión
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Endpoints de Prueba</h5>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <button class="btn btn-outline-primary" onclick="testEndpoint('/api/estados')">
                                <i class="bi bi-list-check"></i> Estados
                            </button>
                            <button class="btn btn-outline-primary" onclick="testEndpoint('/api/unidades-gestion')">
                                <i class="bi bi-building"></i> Unidades de Gestión
                            </button>
                            <button class="btn btn-outline-primary" onclick="testEndpoint('/api/actividades')">
                                <i class="bi bi-calendar-event"></i> Actividades
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Respuesta de la API</h5>
                    </div>
                    <div class="card-body">
                        <pre id="api-response" class="bg-light p-3 rounded" style="max-height: 400px; overflow-y: auto;">Esperando respuesta...</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'https://localhost:7001';
        
        async function testBackend() {
            const statusDiv = document.getElementById('backend-status');
            const responseDiv = document.getElementById('api-response');
            
            statusDiv.className = 'alert alert-info';
            statusDiv.innerHTML = '<i class="bi bi-hourglass-split"></i> Verificando conexión...';
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/estados`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    statusDiv.className = 'alert alert-success';
                    statusDiv.innerHTML = '<i class="bi bi-check-circle"></i> Backend conectado correctamente';
                    
                    const data = await response.json();
                    responseDiv.textContent = JSON.stringify(data, null, 2);
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                statusDiv.className = 'alert alert-danger';
                statusDiv.innerHTML = `<i class="bi bi-x-circle"></i> Error: ${error.message}`;
                responseDiv.textContent = `Error de conexión: ${error.message}`;
            }
        }
        
        async function testEndpoint(endpoint) {
            const responseDiv = document.getElementById('api-response');
            responseDiv.textContent = 'Cargando...';
            
            try {
                const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    responseDiv.textContent = JSON.stringify(data, null, 2);
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                responseDiv.textContent = `Error: ${error.message}`;
            }
        }
        
        // Probar conexión al cargar la página
        window.addEventListener('load', testBackend);
    </script>
</body>
</html> 